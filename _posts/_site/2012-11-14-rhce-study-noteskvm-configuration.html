<h3 id='id1'>知识点</h3>

<p>Virtualization can be divided into five different categories:</p>

<ol>
<li>Bare-metal virtualization: Some VM systems include a minimal operating system dedicated to VM operation. Two examples of bare-metal virtualization systems are VMware ESX and Citrix XenServer.</li>

<li>Hardware-assisted virtualization: A hardware interface where VMs have access to the hardware features of a CPU, such as those described earlier with vmx or svm flags in the /proc/cpuinfo file.</li>

<li>Paravirtualization: While it’s functionally similar to a platform-level VM, it works with fewer resources and usually requires a specialized kernel such as Xen.</li>

<li>Platform-level VMs: Applications such as VMware Player and Virtualbox are open-source edition examples of platform-level VMs that emulate a complete computer system for the installation of a separate operating system.</li>

<li>Application-level: Systems like Wine Is Not an Emulator (WINE) support the installation of a single application. In this case, WINE allows an application designed for Microsoft Windows to be installed on Linux. Loosely, that is one example of an application configured in a VM.</li>
</ol>

<h3 id='install'>Install</h3>

<h4 id='install_seven_packages'>Install Seven Packages：</h4>
<table><thead><tr><th>Package</th><th>Description</th></tr></thead><tbody><tr><td style='text-align: left;'>qemu-kvm</td><td style='text-align: left;'>The main KVM package</td>
</tr><tr><td style='text-align: left;'>python-virtinst</td><td style='text-align: left;'>Command line tools and libraries for creating VMs</td>
</tr><tr><td style='text-align: left;'>virt-manager</td><td style='text-align: left;'>GUI VM administration tool</td>
</tr><tr><td style='text-align: left;'>virt-top</td><td style='text-align: left;'>Command for VM statistics</td>
</tr><tr><td style='text-align: left;'>virt-viewer</td><td style='text-align: left;'>GUI connection to configured VMs</td>
</tr><tr><td style='text-align: left;'>libvirt</td><td style='text-align: left;'>C language toolkit with the libvirtd service</td>
</tr><tr><td style='text-align: left;'>libvirt-client</td><td style='text-align: left;'>C language toolkit for VM clients</td>
</tr></tbody></table>
<h4 id='check_kvm_modules'>Check KVM Modules</h4>

<p>Using command <code>lsmod|grep kvm</code>, the output may be kvm_intel/kvm_amd &amp; kvm modules. If no output, check <code>/proc/cpuinfo</code>, and <code>modprobe kvm</code>.</p>

<h3 id='configuration'>Configuration</h3>

<h4 id='configure_virtual_machine_manager'>Configure Virtual Machine Manager</h4>

<ol>
<li>Virtual Network</li>

<li>Virtual Network Interfaces</li>

<li>Virtual Storage</li>
</ol>

<h4 id='configure_vm'>Configure VM</h4>

<p>KVM-based VMs are normally configured in two different directories:</p>

<ul>
<li>/etc/libvirt/ : VMs configure files are in qemu directory.</li>

<li>/var/lib/libvirt : VM images are stored in images directory.</li>
</ul>

<h3 id='control_vm_from_command_line'>Control VM from Command Line</h3>

<h4 id='install_vms'>Install VMs</h4>

<p>virt-install &#8211;prompt<br />more details: <img alt='' src='/media/11_14_1.png' /></p>

<h4 id='clone_vms'>Clone VMs</h4>

<p>virt-clone &#8211;prompt</p>

<h4 id='start_vms'>Start VMs</h4>

<p>virsh start <pre style='border: solid 3px red; background-color: pink' class='markdown-html-error'>REXML could not parse this XML/HTML: 
&lt;domain&gt;
virsh autostart &lt;domain&gt; </pre></p>

<h4 id='stop_vms'>Stop VMs</h4>

<p>virsh destroy (gracefully) virsh -&gt; shutdown <pre style='border: solid 3px red; background-color: pink' class='markdown-html-error'>REXML could not parse this XML/HTML: 
&lt;domain&gt;
virsh autostart --disable &lt;domain&gt;</pre></p>

<h4 id='list_vms'>List VMs</h4>

<p>virsh list &#8211;all vrish -&gt; list &#8211;all</p>

<h4 id='configure_vms'>Configure VMs</h4>

<p>virsh -&gt; edit <pre style='border: solid 3px red; background-color: pink' class='markdown-html-error'>REXML could not parse this XML/HTML: 
&lt;domain&gt;</pre></p>

<h4 id='how_to_delete_a_vm'>How to Delete a VM</h4>

<ol>
<li>virsh destroy xxx_vm</li>

<li>remove xml file about the VM: /etc/libvirt/qemu/xxx_vm.xml</li>

<li>delete virtual disk files in /var/lib/libvirt/images</li>

<li>restart VM daemon, to erase xxx_vm from RAM: /etc/init.d/libvirtd restart</li>
</ol>